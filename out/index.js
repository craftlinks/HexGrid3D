var z=function(b){for(let F=0;F<1000;++F)b[F*2]=(Math.random()-0.5)*12,b[F*2+1]=(Math.random()-0.5)*12;return b},Q=function(b,F,A,B,D){b[F*2]+=A*D,b[F*2+1]+=B*D},C=function(){const{R_val:b,U_val:F,R_grad:A,U_grad:B}=V,{c_rep:D,mu_k:J,sigma_k:H,w_k:N}=T;b.fill($(0,D)[0]),F.fill(S(0,J,H,N)[0]),A.fill(0),B.fill(0);for(let q=0;q<999;++q)for(let I=q+1;I<1000;++I){let L=P[q*2]-P[I*2],M=P[q*2+1]-P[I*2+1];const O=Math.sqrt(L*L+M*M)+0.00000000000000000001;if(L/=O,M/=O,O<1){const[Y,Z]=$(O,D);Q(A,q,L,M,Z),Q(A,I,L,M,-Z),b[q]+=Y,b[I]+=Y}const[W,X]=S(O,J,H,N);Q(B,q,L,M,X),Q(B,I,L,M,-X),F[q]+=W,F[I]+=W}},$=function(b,F){const A=Math.max(1-b,0);return[0.5*F*A*A,-F*A]},E=function(b){let F=1+b/32;return F*=F,F*=F,F*=F,F*=F,F*=F,F},S=function(b,F,A,B=1){const D=(b-F)/A,J=B/E(D*D);return[J,-2*D*J/A]},G=function(){const{R_val:b,U_val:F,R_grad:A,U_grad:B}=V,{mu_g:D,sigma_g:J,dt:H}=T;C();let N=0;for(let q=0;q<1000;++q){const[I,L]=S(F[q],D,J),M=L*B[q*2]-A[q*2],O=L*B[q*2+1]-A[q*2+1];Q(P,q,M,O,H),N+=b[q]-I}return N/1000},K=function(b,F=40,A=5){for(let H=0;H<A;++H)G();const{width:B,height:D}=b.canvas;b.resetTransform(),b.clearRect(0,0,B,D),b.translate(B/2,D/2);const J=B/F;b.scale(J,J),b.lineWidth=0.1;for(let H=0;H<1000;++H){b.beginPath();const N=P[H*2],q=P[H*2+1],I=T.c_rep/(V.R_val[H]*5);b.arc(N,q,I,0,Math.PI*2),b.stroke()}},h=function(b){let F=window.devicePixelRatio||1,A=b.getBoundingClientRect();b.width=A.width*F,b.height=A.height*F;let B=b.getContext("2d");return B.scale(F,F),B},j=function(){return h(document.querySelector("canvas"))};var T={mu_k:2,sigma_k:0.5,w_k:0.015,mu_g:0.3,sigma_g:0.075,c_rep:1,dt:0.025},V={R_val:new Float32Array(1000),U_val:new Float32Array(1000),R_grad:new Float32Array(2000),U_grad:new Float32Array(2000)},P=z(new Float32Array(2000)),k=j();while(!0)K(k),await new Promise(requestAnimationFrame);
